(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"h+WI":function(e,t,a){"use strict";a.r(t);a("IzEo");var n,i,r,l,o=a("bx4M"),s=(a("g9YV"),a("wCAj")),c=(a("14J3"),a("BMrR")),p=(a("jCWc"),a("kPKH")),d=(a("+L6B"),a("2/Rp")),u=(a("5NDa"),a("5rEg")),m=(a("DZo9"),a("8z0m")),f=(a("Pwec"),a("CtXQ")),h=a("eHn4"),g=a.n(h),v=(a("2qtc"),a("kLXV")),w=a("d6i3"),b=a.n(w),y=a("1l/V"),E=a.n(y),k=(a("/xke"),a("TeRw")),C=a("2Taf"),I=a.n(C),S=a("vZ4D"),x=a.n(S),P=a("l4Ni"),F=a.n(P),V=a("ujKo"),D=a.n(V),L=a("MhPg"),M=a.n(L),O=(a("y8nQ"),a("Vl3Y")),R=(a("OaEy"),a("2fM7")),z=a("q1tI"),N=a.n(z),j=a("MuoO"),J=a("zHco"),B=a("wd/R"),Y=a.n(B),U=a("8kut"),q=a.n(U),A=R["a"].Option;function G(e){return new Promise(function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}})}var H=(n=O["a"].create(),i=Object(j["connect"])(function(e){var t=e.applicant,a=e.loading;return{applicant:t,loading:a.models.applicant}}),n(r=i((l=function(e){function t(){var e,a;I()(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return a=F()(this,(e=D()(t)).call.apply(e,[this].concat(i))),a.state={visible:!1,downloadVisible:!1,previewVisible:!1,previewImage:"",fileList:[],modelName:[],url:null,showVisible:!1},a.columns=[{title:"\u6587\u4ef6\u540d\u79f0",dataIndex:"recordname",render:function(e){var t=/\.{1}[a-z]{1,}$/;return null!==t.exec(e)?N.a.createElement("span",null,e.slice(0,t.exec(e).index)):N.a.createElement("span",null,e)}},{title:"\u4e0a\u4f20\u65e5\u671f",dataIndex:"recorddate",render:function(e){return N.a.createElement("span",null,Y()(e).format("YYYY-MM-DD"))}},{title:"\u4e0a\u4f20\u4eba",dataIndex:"creator"},{title:"\u64cd\u4f5c",render:function(e,t){return N.a.createElement(z["Fragment"],null,N.a.createElement("a",{onClick:function(){return a.previewItem(e,t)}},"\u67e5\u770b"),"\xa0\xa0",N.a.createElement("a",{onClick:function(){return a.deleteItem(e,t)}},"\u5220\u9664"),"\xa0\xa0")}}],a.previewItem=function(e){var t=a.props.dispatch;t({type:"applicant/getOssPdf",payload:{osspath:e.filepath},callback:function(e){if(400===e.code)k["a"].open({message:"\u6253\u5f00\u5931\u8d25",description:e.data});else{var t=e.data;a.setState({url:t})}}}),a.setState({showVisible:!0})},a.deleteItem=function(e){var t=a.props.dispatch;t({type:"applicant/deletePreRecord",payload:{id:e.id},callback:function(e){400===e.code?k["a"].open({message:"\u5220\u9664\u5931\u8d25",description:e.data}):a.componentDidMount()}})},a.handleOk=function(){var e=a.props,t=e.form.validateFieldsAndScroll,n=e.dispatch,i=sessionStorage.getItem("prereportno");t(function(e,t){if(!e){var r=new FormData,l=JSON.parse(localStorage.getItem("consignor_userinfo"));t.MultipartFile.fileList.forEach(function(e){r.append("files",e.originFileObj)}),r.append("prereportno",i),r.append("creator",l.userName),n({type:"applicant/upload",payload:r,callback:function(e){400===e.code?k["a"].open({message:"\u6dfb\u52a0\u5931\u8d25",description:e.message}):a.componentDidMount()}}),a.setState({visible:!1}),form.resetFields()}console.log(e)})},a.show=function(){var e=a.props,t=e.form;e.dispatch,sessionStorage.getItem("reportno");t.resetFields(),a.setState({fileList:[]}),a.setState({visible:!0})},a.handleCancel=function(){var e=a.props.form;e.resetFields(),a.setState({visible:!1})},a.onChange=function(e){"\u6309\u5355\u4ef7"===e.target.value||"\u6309\u6bd4\u4f8b"===e.target.value?a.setState({showPrice:!0}):a.setState({showPrice:!1})},a.Cancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(){var e=E()(b.a.mark(function e(t){return b.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,G(t.originFileObj);case 3:t.preview=e.sent;case 4:a.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){var t=e.file,n=e.fileList,i="image/jpg"===t.type,r="image/jpeg"===t.type,l="image/gif"===t.type,o="image/png"===t.type,s="application/pdf"===t.type,c=t.size/1024/1024<20;if(i||r||l||o||s)if(c){var p=t.name,d=/\.{1}[a-z]{1,}$/;null!==d.exec(p)&&(p=p.slice(0,d.exec(p).index));var u=a.props.form;u.setFieldsValue(g()({},"filename",p)),a.setState({fileList:n})}else v["a"].error({title:"\u8d85\u8fc720M\u9650\u5236\uff0c\u4e0d\u5141\u8bb8\u4e0a\u4f20~"});else v["a"].error({title:"\u53ea\u80fd\u4e0a\u4f20JPG \u3001JPEG \u3001GIF\u3001 PNG\u3001 PDF\u683c\u5f0f\u7684\u56fe\u7247~"})},a.handleBeforeUpload=function(e){return!1},a.back=function(){a.props.history.goBack()},a.showCancel=function(){a.setState({showVisible:!1})},a}return M()(t,e),x()(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch,t=sessionStorage.getItem("prereportno");e({type:"applicant/getPreRecord",payload:{prereportno:t}})}},{key:"render",value:function(){var e=N.a.createElement("div",null,N.a.createElement(f["a"],{type:"plus"}),N.a.createElement("div",{className:"ant-upload-text"},"Upload")),t=this.props,a=t.applicant.preRecordData,n=t.loading,i=t.form.getFieldDecorator,r=this.state,l=r.fileList,h=r.visible,g=r.previewVisible,w=r.previewImage,b=(r.downloadVisible,r.modelName),y=r.url,E=r.showVisible,k=(b.map(function(e){return N.a.createElement(A,{key:e,value:e},e)}),sessionStorage.getItem("shipname")),C={shipname:k};return N.a.createElement(J["a"],{text:C},N.a.createElement(v["a"],{title:"\u6587\u4ef6\u4e0a\u4f20",visible:h,onOk:this.handleOk,onCancel:this.handleCancel},N.a.createElement(O["a"],null,N.a.createElement(O["a"].Item,{label:"\u6587\u4ef6\u4e0a\u4f20"},i("MultipartFile",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4e0a\u4f20\u6587\u4ef6"}]})(N.a.createElement(m["a"],{listType:"picture-card",fileList:l,onPreview:this.handlePreview,beforeUpload:this.handleBeforeUpload,onChange:this.handleChange},l.length>=1?null:e))),N.a.createElement(O["a"].Item,{label:"\u6587\u4ef6\u540d\u79f0"},i("filename",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6587\u4ef6\u540d\u79f0"}]})(N.a.createElement(u["a"],{style:{width:"100%"},placeholder:"\u8bf7\u8f93\u5165\u6587\u4ef6\u540d\u79f0"}))),N.a.createElement(v["a"],{visible:g,footer:null,onCancel:this.Cancel},N.a.createElement("img",{alt:"example",style:{width:"100%"},src:w})))),N.a.createElement(o["a"],{bordered:!1,size:"small"},N.a.createElement(c["a"],null,N.a.createElement(p["a"],{span:22},N.a.createElement(d["a"],{style:{marginBottom:12},type:"primary",onClick:this.show},"\u4e0a\u4f20\u6587\u4ef6")),N.a.createElement(p["a"],{span:2},N.a.createElement(d["a"],{type:"primary",style:{marginLeft:8,paddingLeft:0,paddingRight:15},onClick:this.back},N.a.createElement(f["a"],{type:"left"}),"\u8fd4\u56de"))),N.a.createElement("div",{className:q.a.tableList},N.a.createElement(s["a"],{size:"middle",loading:n,dataSource:a,columns:this.columns,rowKey:"id",pagination:{showQuickJumper:!0,showSizeChanger:!0}}))),N.a.createElement(v["a"],{title:"\u8bb0\u5f55\u8be6\u60c5",visible:E,onCancel:this.showCancel,footer:null,width:800,style:{top:10}},N.a.createElement("embed",{src:y,width:"700",height:"700"})))}}]),t}(z["PureComponent"]),r=l))||r)||r);t["default"]=H}}]);